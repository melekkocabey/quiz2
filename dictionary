from PIL import Image
import numpy as np
import collections
import os
cwd = os.getcwd()
import random


def convertToArray(pathToImage):
    img = Image.open(pathToImage)
    return np.array(img)

def convertToPIL(pathToImage):
    
    img = Image.open(pathToImage)
    copied = img.copy()
    del img

    return copied


def saveImages(mainPath):
    lis = []
    for filename in os.listdir(mainPath):
        pth = "dataset/" + str(filename)
        print "pth: " + pth
        li = []
        if not os.path.isdir(pth):
            print "pth is not dir"
            continue

        for filen in os.listdir(pth):
            new_path = pth + "/" + str(filen)
            print new_path
            li.append((convertToPIL(new_path), str(new_path)))
        lis.append(li)
    return lis

        
#imageList = saveImages("dataset") # list of people list. e.g. [[1.1,1.2,1.3...], [2.1,2.2,2.3...], ...]


def randomSelection(li):
    DatasetDictionary = collections.OrderedDict()
    DatasetDictionary_OnlyNames = collections.OrderedDict()

    Train_Data = []
    Train_Data_OnlyNames = []
    Test_Data = []
    Test_Data_OnlyNames = []

    for l in li:
        karistir = l
        random.shuffle(karistir)
        siz = len(karistir)
        test_size = int(siz*0.3) 
        test_set = karistir[:test_size]
        train_set = karistir[test_size:] 
        filename = test_set[1][1]
        for test in test_set:
            Test_Data.append(test)
            Test_Data_OnlyNames.append(test[1])
        for train in train_set:
            Train_Data.append(train)
            Train_Data_OnlyNames.append(train[1])
    DatasetDictionary['Train'] = Train_Data
    DatasetDictionary['Test'] = Test_Data
    DatasetDictionary_OnlyNames['Train'] = Train_Data_OnlyNames
    DatasetDictionary_OnlyNames['Test'] = Test_Data_OnlyNames
    return (DatasetDictionary, DatasetDictionary_OnlyNames)


listOfImages = saveImages("dataset")
dictionaryOfImages = randomSelection(listOfImages)
print(dictionaryOfImages)







